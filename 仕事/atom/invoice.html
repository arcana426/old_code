<!DOCTYPE html>
<html lang="ja" dir="ltr">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>登録完了</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
</head>

<body>
  <section class="hero is-warning">
    <section class="section">
      <div class="container">
        <div class="hero-body" id="app">
          <p class="title is-size-1">
            登録完了
          </p>

          <p class="is-size-3">お客様の会員登録が正常に完了いたしました。</p>
          <p class="is-size-3 has-text-danger">3日以内に<span class="has-text-weight-bold">9,800</span>円お支払いください。</p>
          <p class="is-size-3 has-text-danger">お支払いが確認できない場合は<span
              class="has-text-weight-bold">法的処置</span>を取らせていただきますのでご注意ください。</p>
          <p class="is-size-3 has-text-danger"><span class="has-text-weight-bold">下の連絡先に今すぐお問い合わせください。</span></p>
          <div class="notification is-danger" v-bind:style="{background: color}">
            <p class="is-size-3 has-text-centered">残り<span id="hour">6</span>時間<span id="min">0</span>分<span
                id="sec">0</span>秒</p>
          </div>
        </div>
    </section>
    </div>
  </section>
  <section class="section">
    <h2 class="title">お客様情報</h2>
  </section>
  <table class="table is-striped is-fullwidth is-narrow is-hoverable">
    <tr>
      <td>お使いのOS</td>
      <td id="osInfo"></td>
    </tr>
    <tr>
      <td>登録日時</td>
      <td id="accessTime"></td>
    </tr>
    <tr>
      <td>IPアドレス</td>
      <td id="ipAddress"></td>
    </tr>
    <tr>
      <td>あなたのプロバイダーは</td>
      <td id="providerDisplay"></td>
    </tr>
    <tr>
      <td>あなたのリモートホストIPは</td>
      <td id="remoteHostInfo"></td>
    </tr>
    <tr>
      <td>あなたの国</td>
      <td id="countryName"></td>
    </tr>
    <tr>
      <td>あなたの都道府県</td>
      <td id="region"></td>
    </tr>
    <tr>
      <td>あなたの電池残量</td>
      <td id="batteryStatus"></td>
    </tr>
    <tr>
      <td>充電しているか</td>
      <td id="chargingStatus"></td>
    </tr>

  </table>

  <p id="errorDisplay" class="has-text-danger"></p>

  <section class="section">
    <h2 class="title">お問合せ</h2>
  </section>
  <table class="table is-striped is-fullwidth is-narrow is-hoverable">
    <tr>
      <td>電話番号</td>
      <td>0120-000-000</td>
    </tr>
    <tr>
      <td>メールアドレス</td>
      <td>info@example.com</td>
    </tr>
  </table>
  <section class="section">
    <h2 class="title">お振込先</h2>
  </section>

  <table class="table is-striped is-fullwidth is-narrow is-hoverable">
    <tr>
      <td>銀行名(銀行コード)</td>
      <td>極道銀行(5910)</td>
    </tr>
    <tr>
      <td>支店名(支店コード)</td>
      <td>八草支店(893)</td>
    </tr>
    <tr>
      <td>種別</td>
      <td>普通預金</td>
    </tr>
    <tr>
      <td>口座番号</td>
      <td>5910696</td>
    </tr>
  </table>
  <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.slim.min.js"
    integrity="sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/platform/1.3.6/platform.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

  <script src="invoice.js"></script>
  <script type="text/javascript">
    const app = new Vue({
      el: "#app",
      data: {
        count: 3 * 24 * 60 * 60,
        color: "black"
      },
      created() {
        setInterval(() => {
          $("#hour").text(Math.floor(this.count / 3600));
          $("#min").text(Math.floor((this.count % 3600) / 60));
          $("#sec").text(Math.floor(this.count % 60));
          this.count = this.count - 1
          if (this.color === "black") {
            this.color = "red"
          } else {
            this.color = "black"
          }
        }, 1000)
      }
    })

    function getOSInfo() {
      const userAgent = navigator.userAgent;
      const osInfo = detectOS(userAgent);
      document.getElementById('osInfo').textContent = osInfo;
    }

    function detectOS(userAgent) {
      let os = '不明';
      if (/CrOS/.test(userAgent)) {
        os = 'Chrome OS';
      } else if (/Windows/.test(userAgent)) {
        os = 'Windows';
      } else if (/Mac/.test(userAgent)) {
        os = 'Mac OS';
      } else if (/Linux/.test(userAgent)) {
        os = 'Linux';
      } else if (/Android/.test(userAgent)) {
        os = 'Android';
      } else if (/iOS/.test(userAgent)) {
        os = 'iOS';
      } else if (/Unix/.test(userAgent)) {
        os = 'Unix';
      }
      return os;
    }

    // Call the getOSInfo function
    getOSInfo();


    // IPアドレス情報を取得
    const ipAddressElement = document.getElementById('ipAddress');
    fetch('https://ipinfo.io/json')
      .then(response => response.json())
      .then(data => {
        const ipAddress = data.ip || '情報なし';
        ipAddressElement.innerText = `IPアドレス: ${ipAddress}`;
      })
      .catch(error => {
        console.error('IPアドレス情報の取得に失敗しました:', error);
        ipAddressElement.innerText = 'IPアドレス情報の取得に失敗しました';
      });

    async function fetchProviderInfoWithBackoff() {
      try {
        const response = await fetch('https://ipinfo.io/json');

        if (response.status === 429) {
          // If rate-limited, wait for a specified time (e.g., 1 second) and retry
          await new Promise(resolve => setTimeout(resolve, 1000));
          return fetchProviderInfoWithBackoff();
        }

        const data = await response.json();
        const provider = data.org || '不明';
        document.getElementById('providerDisplay').innerText = provider;
      } catch (error) {
        handleError(error);
      }
    }

    // Call the function
    fetchProviderInfoWithBackoff();

    // バッテリー情報を取得
    async function fetchBatteryStatus() {
      try {
        const battery = await navigator.getBattery();
        const batteryLevel = (battery.level * 100).toFixed(2);
        document.getElementById('batteryStatus').innerText = `バッテリー残量: ${batteryLevel}%`;
        const chargingStatus = battery.charging ? '充電中' : '充電されていません';
        document.getElementById('chargingStatus').innerText = `充電ステータス: ${chargingStatus}`;
      } catch (error) {
        console.error('バッテリー情報の取得に失敗しました:', error);
        document.getElementById('batteryStatus').innerText = 'バッテリー情報の取得に失敗しました';
      }
    }

    function displayAccessTime() {
      var currentTime = new Date();
      var formattedTime = currentTime.toLocaleString("ja-JP");
      document.getElementById('accessTime').innerText = formattedTime;
    }

    function displayRegistrationDate() {
      $("#date").text(new Date().toLocaleString("ja-JP"));
    }

    function handleError(error) {
      console.error('Error:', error);
      const errorDisplayElement = document.getElementById('errorDisplay');
      errorDisplayElement.textContent = 'エラーが発生しました。後でもう一度お試しください。';
    }

    // リモートホスト情報を取得
    async function getRemoteHostInfo() {
      try {
        const response = await fetch('https://ipinfo.io/json');
        const data = await response.json();
        const remoteHostInfo = data.hostname || '情報なし';
        document.getElementById('remoteHostInfo').textContent = remoteHostInfo;
      } catch (error) {
        console.error('リモートホスト情報の取得に失敗しました:', error);
        document.getElementById('remoteHostInfo').textContent = '情報なし';
      }
    }

    // 都道府県情報を取得
    function getRegionInfo() {
      axios.get('https://ipapi.co/json/')
        .then(response => {
          const region = response.data.region || '不明';
          document.getElementById('region').innerText = `都道府県: ${region}`;
        })
        .catch(error => {
          console.error('都道府県情報の取得に失敗しました:', error);
          document.getElementById('region').innerText = '都道府県情報の取得に失敗しました';
        });
    }

    // ページが読み込まれたときに実行
    document.addEventListener('DOMContentLoaded', function () {
      getOSInfo();
      displayAccessTime();
      fetchProviderInfoWithBackoff();
      fetchBatteryStatus();
      getRemoteHostInfo();
      displayRegistrationDate();
      getRegionInfo();
    });



    document.addEventListener("DOMContentLoaded", function () {
      const se = new Audio("takashi.wav");

      document.addEventListener("click", function () {
        se.play()
          .catch(error => {
            console.error("Audio playback failed:", error.name, error.message, error.stack);
          });
      });
    });




    // ページが読み込まれたときに実行する関数
    window.onload = function () {
      getCountryInfo();
    };

    function getCountryInfo() {
      const apiUrl = 'https://ipapi.co/json/';

      fetch(apiUrl)
        .then(response => response.json())
        .then(data => {
          const country = data.country_name;

          // テーブルのセルに情報を表示
          document.getElementById('countryName').innerText = country;
          document.getElementById('ipAddress').innerText = data.ip;
          document.getElementById('region').innerText = data.region;
        })
        .catch(error => {
          console.error('エラーが発生しました:', error);
        });
    }




  </script>

</html>